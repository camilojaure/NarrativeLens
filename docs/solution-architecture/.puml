@startuml
title NarrativeLens Workflow: From Scraping to Insights

actor "Analyst" as User
participant "Scraper\n(TikTok Ads)" as Scraper
participant "Pre-processing\nModule" as PM
participant "Deep Learning\nModels (Gemini + UGC)" as DLM
participant "MongoDB\nStorage" as DB
participant "ETL & EDA\nModule" as ED
participant "Modeling\nModule" as MM

User -> Scraper: 1. Scrape TikTok Video Ads (~500+)
activate Scraper
Scraper -> Scraper: Download and store raw videos
Scraper -> DB: Save raw video files and metadata
deactivate Scraper

User -> PM: 2. Run pre-processing (featureExtractor.py)
activate PM
PM -> DLM: 2a. Extract Gemini-based CDS features
DLM --> PM: Return scene-level features
User -> DLM: 2b (optional). UGC detection
DLM --> PM: Return UGC labels
PM -> PM: Validate outputs via Pydantic data model
PM -> DB: Save labeled features and UGC flags
deactivate PM

User -> ED: 3. Run analytical layer
activate ED
ED -> DB: Load labeled video dataset
ED -> ED: Run `etl.py` to format and structure data
ED -> ED: Execute EDA notebook (cleaning, exploration)
ED -> DB: Store cleaned dataset
deactivate ED

User -> MM: 4. Run modeling analysis
activate MM
MM -> DB: Load cleaned dataset
MM -> MM: Run regression (OLS) & Random Forest modeling notebooks
MM -> DB: Save modeling results (coefficients, importances)
deactivate MM

User -> User: 5. Review results for thesis insights
@enduml